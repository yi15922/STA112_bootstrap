---
title: "HW 09 - Bootstrapping the GSS"
author: "Team yiit"
date: "2018-11-03"
output: github_document
---

### Load packages

```{r load-packages, message=FALSE}
library(infer)
library(tidyverse)
```

### Load data

```{r load-data, message=FALSE}

gss2016 <- read_csv("gss2016.csv")

```

### Set seed

```{r set-seed}
set.seed(12354)
```

### Exercise 1

```{r}
gss2016 %>%
  count(harass5)
```

The possible responses to this question are Does not apply (i do not have a job/superior/co-worker), Don't know, No, No answer, Not applicable, and Yes. The number of people who said each response is 96, 1, 1136, 7, 1390, and 237 respectively.

### Exercise 2

```{r filter-harass5}
harassed <- gss2016 %>%
  filter(harass5 == "Yes" | harass5 == "No")
```

### Exercise 3

```{r harass5-prop}
harassed %>%
  group_by(harass5) %>%
  summarise(n = n()) %>%
  mutate(prop = scales::percent(n / sum(n)))
```

82.7% of respondents for whom this question is applicable to have been harassed by their superiors or co-workers at their job.

### Exercise 4

```{r visualize-bootstrap}

harass_bs <- 
  harassed %>%
    specify(response = harass5, success = "Yes") %>% 
    generate(reps = 1000, type = "bootstrap") %>% 
    calculate(stat = "prop")

harass_bs

ggplot(data = harass_bs, 
       mapping = aes(x = stat)) +
  geom_histogram(binwidth = 0.005, 
                 fill = "Grey", 
                 color = "Black") +
  labs(title = "Americans who have been harassed at work",
       subtitle = "Bootstrap distribution of proportions",
       x = "Proportion",
       y = "Count")

```

### Exercise 5

```{r harass5-confint}
harass_bs %>%
  summarise(
    lower = quantile(stat, 0.025),
    upper = quantile(stat, 0.975),
    )
```

The 95% bootstrap confidence interval based on the distribution we constructed above is 0.152 to 0.192.


### Exercise 6

We are 95% confident that the median percentage of those who have been harassed by their superiors or co-workers at their job is between 15.2% and 19.2%.

### Exercise 7

To be 95% confident means that that there is a 95% chance that the confidence interval determined contains the true value of the proportion of Americans who are harassed at work. We can say with 95% confidence, or certainty, that the true percentage of Americans who are harassed at work lies within our confidence interval.

### Exercise 8

90% confidence interval: (0.157, 0.189)

99% confidence interval: (0.147, 0.196)

If the confidence that our interval contains the true proportion of Americans who are harassed at work increases, then the interval must become wider, and vice versa. This is because as the interval widens to cover more potential proportion values, there is a greater probability (or confidence) that it contains the true proportion.

### Exercise 9

```{r}

```



### Exercise 10

```{r}

```

### Exercise 11

```{r}

```



### Exercise 12

```{r}

```

### Exercise 13

```{r}

```



### Exercise 14

```{r}

```

### Exercise 15

```{r}

```



### Exercise 16

```{r}

```

### Exercise 17

```{r}

```



### Exercise 18

```{r}

```

### Exercise 19

```{r}

```


